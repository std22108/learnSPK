<!doctype html>
<html lang="th">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ทักษะการทำงานร่วมกันและการจัดการ - การงานอาชีพ ม.3</title>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet">
  <style>
        body {
            box-sizing: border-box;
        }
        
        :root {
            --primary: #1565C0;
            --accent: #FFC107;
            --primary-light: #42A5F5;
            --primary-dark: #0D47A1;
            --accent-dark: #FF8F00;
            --bg-light: #F8F9FA;
            --text-dark: #212529;
            --text-light: #6C757D;
            --success: #28A745;
            --danger: #DC3545;
            --white: #FFFFFF;
            --shadow: 0 2px 10px rgba(0,0,0,0.1);
            --shadow-lg: 0 4px 20px rgba(0,0,0,0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Prompt', sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background: linear-gradient(135deg, var(--bg-light) 0%, #E3F2FD 100%);
            min-height: 100%;
        }

        /* Navigation */
        .navbar {
            background: var(--white);
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
            padding: 1rem 0;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary);
        }

        .nav-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        /* Progress Bar */
        .progress-container {
            background: var(--white);
            padding: 0.5rem 0;
            border-bottom: 1px solid #E0E0E0;
        }

        .progress-bar {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .progress {
            width: 100%;
            height: 8px;
            background: #E0E0E0;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary) 0%, var(--accent) 100%);
            width: 0%;
            transition: width 0.3s ease;
        }

        .progress-text {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-top: 0.5rem;
            text-align: center;
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: var(--white);
            padding: 4rem 0;
            text-align: center;
        }

        .hero-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .hero h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }

        .hero-subtitle {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            opacity: 0.9;
        }

        .hero-description {
            font-size: 1.1rem;
            margin-bottom: 2rem;
            opacity: 0.8;
        }

        .btn {
            display: inline-block;
            padding: 0.75rem 2rem;
            border: none;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 500;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .btn-primary {
            background: var(--accent);
            color: var(--text-dark);
        }

        .btn-primary:hover {
            background: var(--accent-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn-secondary:hover {
            background: var(--primary);
            color: var(--white);
        }

        .btn-success {
            background: var(--success);
            color: var(--white);
        }

        .btn-success:hover {
            background: #218838;
        }

        /* Main Content */
        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        .lesson-section {
            background: var(--white);
            border-radius: 15px;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
            overflow: hidden;
        }

        .section-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: var(--white);
            padding: 1.5rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .section-header:hover {
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary) 100%);
        }

        .section-header.locked {
            background: #9E9E9E;
            cursor: not-allowed;
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .section-icon {
            font-size: 1.5rem;
            transition: transform 0.3s ease;
        }

        .section-content {
            padding: 2rem;
            display: none;
        }

        .section-content.active {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .content-text {
            font-size: 1.1rem;
            line-height: 1.8;
            margin-bottom: 1.5rem;
        }

        .highlight-box {
            background: linear-gradient(135deg, #E3F2FD 0%, #F3E5F5 100%);
            border-left: 4px solid var(--primary);
            padding: 1.5rem;
            border-radius: 8px;
            margin: 1.5rem 0;
        }

        .highlight-title {
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        /* Activity Styles */
        .activity-container {
            background: #F8F9FA;
            border-radius: 10px;
            padding: 2rem;
            margin: 2rem 0;
            border: 2px dashed var(--accent);
        }

        .activity-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 1rem;
            text-align: center;
        }

        /* Drag and Drop Activity */
        .drag-drop-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin: 1rem 0;
        }

        .drag-source, .drop-zone {
            min-height: 200px;
            border-radius: 10px;
            padding: 1rem;
        }

        .drag-source {
            background: var(--white);
            border: 2px solid var(--primary-light);
        }

        .drop-zone {
            background: #E8F5E8;
            border: 2px dashed var(--success);
        }

        .drag-item {
            background: var(--primary-light);
            color: var(--white);
            padding: 0.75rem;
            margin: 0.5rem 0;
            border-radius: 8px;
            cursor: grab;
            transition: all 0.3s ease;
            user-select: none;
        }

        .drag-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .drag-item.dragging {
            opacity: 0.5;
            cursor: grabbing;
        }

        /* Kanban Board */
        .kanban-board {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .kanban-column {
            background: var(--white);
            border-radius: 10px;
            padding: 1rem;
            min-height: 300px;
            border: 2px solid #E0E0E0;
        }

        .kanban-header {
            font-weight: 600;
            text-align: center;
            padding: 0.5rem;
            border-radius: 5px;
            margin-bottom: 1rem;
        }

        .todo-header {
            background: #FFECB3;
            color: var(--text-dark);
        }

        .doing-header {
            background: #E1F5FE;
            color: var(--text-dark);
        }

        .done-header {
            background: #E8F5E8;
            color: var(--text-dark);
        }

        .kanban-card {
            background: var(--white);
            border: 1px solid #E0E0E0;
            border-radius: 8px;
            padding: 1rem;
            margin: 0.5rem 0;
            cursor: grab;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .kanban-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .add-card-btn {
            width: 100%;
            padding: 0.5rem;
            background: transparent;
            border: 2px dashed var(--primary-light);
            border-radius: 8px;
            color: var(--primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .add-card-btn:hover {
            background: var(--primary-light);
            color: var(--white);
        }

        /* Quiz Styles */
        .quiz-container {
            background: var(--white);
            border-radius: 10px;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: var(--shadow);
        }

        .quiz-question {
            font-size: 1.1rem;
            font-weight: 500;
            margin-bottom: 1rem;
            color: var(--text-dark);
        }

        .quiz-options {
            display: grid;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .quiz-option {
            padding: 1rem;
            border: 2px solid #E0E0E0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--white);
        }

        .quiz-option:hover {
            border-color: var(--primary-light);
            background: #F3E5F5;
        }

        .quiz-option.selected {
            border-color: var(--primary);
            background: var(--primary-light);
            color: var(--white);
        }

        .quiz-option.correct {
            border-color: var(--success);
            background: #E8F5E8;
            color: var(--success);
        }

        .quiz-option.incorrect {
            border-color: var(--danger);
            background: #FFEBEE;
            color: var(--danger);
        }

        .quiz-feedback {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 8px;
            display: none;
        }

        .quiz-feedback.show {
            display: block;
        }

        .quiz-feedback.correct {
            background: #E8F5E8;
            color: var(--success);
            border: 1px solid var(--success);
        }

        .quiz-feedback.incorrect {
            background: #FFEBEE;
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        .quiz-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 2rem;
        }

        .quiz-progress {
            font-size: 0.9rem;
            color: var(--text-light);
        }

        /* Score Display */
        .score-display {
            background: linear-gradient(135deg, var(--success) 0%, #66BB6A 100%);
            color: var(--white);
            padding: 2rem;
            border-radius: 15px;
            text-align: center;
            margin: 2rem 0;
            box-shadow: var(--shadow-lg);
        }

        .score-number {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .score-text {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        /* Footer */
        .footer {
            background: var(--text-dark);
            color: var(--white);
            text-align: center;
            padding: 2rem 0;
            margin-top: 4rem;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .footer p {
            margin-bottom: 0.5rem;
            opacity: 0.8;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2rem;
            }

            .hero-subtitle {
                font-size: 1rem;
            }

            .drag-drop-container {
                grid-template-columns: 1fr;
            }

            .kanban-board {
                grid-template-columns: 1fr;
            }

            .nav-container {
                flex-direction: column;
                gap: 1rem;
            }

            .nav-actions {
                flex-wrap: wrap;
                justify-content: center;
            }
        }

        /* Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Focus styles */
        .btn:focus,
        .quiz-option:focus,
        .drag-item:focus,
        .kanban-card:focus {
            outline: 3px solid var(--accent);
            outline-offset: 2px;
        }

        /* Animation for completed activities */
        .completed-activity {
            border-color: var(--success);
            background: linear-gradient(135deg, #E8F5E8 0%, #F1F8E9 100%);
        }

        .completed-activity .activity-title::after {
            content: " ✓";
            color: var(--success);
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body><!-- Navigation -->
  <nav class="navbar" role="navigation" aria-label="เมนูหลัก">
   <div class="nav-container">
    <div class="logo">
     การงานอาชีพ ม.3
    </div>
    <div class="nav-actions"><button class="btn btn-secondary" onclick="resetProgress()" aria-label="รีเซ็ตความคืบหน้า"> 🔄 รีเซ็ต </button> <button class="btn btn-secondary" onclick="printResults()" aria-label="พิมพ์ผลการเรียน"> 🖨️ พิมพ์ผล </button>
     <div class="score-badge" id="currentScore" aria-live="polite">
      คะแนน: <span id="scoreValue">0</span>%
     </div>
    </div>
   </div>
  </nav><!-- Progress Bar -->
  <div class="progress-container">
   <div class="progress-bar">
    <div class="progress">
     <div class="progress-fill" id="progressFill"></div>
    </div>
    <div class="progress-text" id="progressText">
     ความคืบหน้า: 0%
    </div>
   </div>
  </div><!-- Hero Section -->
  <header class="hero">
   <div class="hero-container">
    <h1 id="lessonTitle">ทักษะการทำงานร่วมกันและการจัดการ</h1>
    <p class="hero-subtitle" id="schoolName">โรงเรียนสารคามพิทยาคม สพม.มหาสารคาม</p>
    <p class="hero-subtitle">ครูผู้สอน: <span id="teacherName">นางปัญจรัศม์ แซ่ตัง</span></p>
    <p class="hero-description" id="lessonDescription">เรียนรู้ทักษะการทำงานเป็นทีมและการจัดการเวลาอย่างมีประสิทธิภาพ</p><button class="btn btn-primary" onclick="startLesson()" aria-label="เริ่มเรียนบทเรียน"> 🚀 เริ่มเรียน </button>
   </div>
  </header><!-- Main Content -->
  <main class="main-content" role="main"><!-- Section 1: ความหมายและความสำคัญ -->
   <section class="lesson-section" id="section1">
    <div class="section-header" onclick="toggleSection(1)" role="button" tabindex="0" aria-expanded="false">
     <h2 class="section-title">1. ความหมายและความสำคัญของการทำงานร่วมกัน</h2><span class="section-icon">📚</span>
    </div>
    <div class="section-content" id="content1">
     <div class="content-text">
      <p>การทำงานร่วมกันเป็นกระบวนการที่บุคคลตั้งแต่ 2 คนขึ้นไป มาร่วมมือกันทำงานเพื่อให้บรรลุเป้าหมายที่กำหนดไว้ โดยแต่ละคนจะมีหน้าที่และบทบาทที่แตกต่างกัน แต่ต้องประสานงานกันอย่างมีประสิทธิภาพ</p>
     </div>
     <div class="highlight-box">
      <div class="highlight-title">
       ประโยชน์ของการทำงานร่วมกัน
      </div>
      <ul>
       <li>ได้แนวคิดและมุมมองที่หลากหลาย</li>
       <li>แบ่งปันภาระงานและความรับผิดชอบ</li>
       <li>เพิ่มประสิทธิภาพและความรวดเร็วในการทำงาน</li>
       <li>สร้างความสัมพันธ์ที่ดีในทีม</li>
       <li>พัฒนาทักษะการสื่อสารและการแก้ปัญหา</li>
      </ul>
     </div><!-- กิจกรรมที่ 1: จับคู่บทบาทในทีม -->
     <div class="activity-container" id="activity1">
      <div class="activity-title">
       🎯 กิจกรรม: จับคู่บทบาทในทีมงาน
      </div>
      <p>ลากบทบาทต่างๆ ไปใส่ในหน้าที่ที่ถูกต้อง</p>
      <div class="drag-drop-container">
       <div class="drag-source">
        <h4>บทบาทในทีม</h4>
        <div class="drag-item" draggable="true" data-role="leader">
         ผู้นำทีม (Leader)
        </div>
        <div class="drag-item" draggable="true" data-role="recorder">
         ผู้บันทึก (Recorder)
        </div>
        <div class="drag-item" draggable="true" data-role="timekeeper">
         ผู้ดูแลเวลา (Timekeeper)
        </div>
        <div class="drag-item" draggable="true" data-role="facilitator">
         ผู้อำนวยความสะดวก (Facilitator)
        </div>
       </div>
       <div class="drop-zone" id="roleDropZone">
        <h4>หน้าที่: วางแผนและประสานงาน</h4>
        <p>ลากบทบาทที่เหมาะสมมาวางที่นี่</p>
       </div>
      </div><button class="btn btn-success" onclick="checkActivity1()" style="margin-top: 1rem;"> ✅ ตรวจคำตอบ </button>
     </div>
    </div>
   </section><!-- Section 2: การสื่อสารในทีม -->
   <section class="lesson-section" id="section2">
    <div class="section-header locked" onclick="toggleSection(2)" role="button" tabindex="0" aria-expanded="false">
     <h2 class="section-title">2. การสื่อสารอย่างมีประสิทธิภาพ</h2><span class="section-icon">🔒</span>
    </div>
    <div class="section-content" id="content2">
     <div class="content-text">
      <p>การสื่อสารที่ดีเป็นหัวใจสำคัญของการทำงานร่วมกัน ต้องมีการฟังอย่างตั้งใจ (Active Listening) และการถามคำถามที่เหมาะสม</p>
     </div>
     <div class="highlight-box">
      <div class="highlight-title">
       หลัก 5W1H ในการสื่อสาร
      </div>
      <ul>
       <li><strong>Who</strong> - ใครเป็นผู้รับผิดชอบ</li>
       <li><strong>What</strong> - อะไรคือสิ่งที่ต้องทำ</li>
       <li><strong>When</strong> - เมื่อไหร่ต้องเสร็จ</li>
       <li><strong>Where</strong> - ที่ไหนคือสถานที่ทำงาน</li>
       <li><strong>Why</strong> - ทำไมต้องทำงานนี้</li>
       <li><strong>How</strong> - อย่างไรจะทำให้สำเร็จ</li>
      </ul>
     </div><!-- กิจกรรมที่ 2: จัดลำดับขั้นตอนการสื่อสาร -->
     <div class="activity-container" id="activity2">
      <div class="activity-title">
       🗣️ กิจกรรม: จัดลำดับขั้นตอนการสื่อสารที่ดี
      </div>
      <p>ลากขั้นตอนต่างๆ เพื่อจัดเรียงตามลำดับที่ถูกต้อง</p>
      <div class="drag-drop-container">
       <div class="drag-source">
        <h4>ขั้นตอนการสื่อสาร</h4>
        <div class="drag-item" draggable="true" data-step="3">
         สรุปและยืนยันความเข้าใจ
        </div>
        <div class="drag-item" draggable="true" data-step="1">
         ฟังอย่างตั้งใจ
        </div>
        <div class="drag-item" draggable="true" data-step="4">
         ติดตามผลการปฏิบัติ
        </div>
        <div class="drag-item" draggable="true" data-step="2">
         ถามคำถามเพื่อความชัดเจน
        </div>
       </div>
       <div class="drop-zone" id="communicationDropZone">
        <h4>ลำดับที่ถูกต้อง</h4>
        <p>วางขั้นตอนตามลำดับที่ถูกต้อง</p>
       </div>
      </div><button class="btn btn-success" onclick="checkActivity2()" style="margin-top: 1rem;"> ✅ ตรวจคำตอบ </button>
     </div>
    </div>
   </section><!-- Section 3: การจัดการเวลา -->
   <section class="lesson-section" id="section3">
    <div class="section-header locked" onclick="toggleSection(3)" role="button" tabindex="0" aria-expanded="false">
     <h2 class="section-title">3. การจัดการเวลาและการวางแผน</h2><span class="section-icon">🔒</span>
    </div>
    <div class="section-content" id="content3">
     <div class="content-text">
      <p>การจัดการเวลาอย่างมีประสิทธิภาพช่วยให้ทีมงานสามารถทำงานได้ตามกำหนดเวลา โดยใช้เทคนิคต่างๆ เช่น Timeboxing และ Eisenhower Matrix</p>
     </div>
     <div class="highlight-box">
      <div class="highlight-title">
       Eisenhower Matrix - การจัดลำดับความสำคัญ
      </div>
      <ul>
       <li><strong>สำคัญและเร่งด่วน</strong> - ทำทันที</li>
       <li><strong>สำคัญแต่ไม่เร่งด่วน</strong> - วางแผนทำ</li>
       <li><strong>ไม่สำคัญแต่เร่งด่วน</strong> - มอบหมายให้ผู้อื่น</li>
       <li><strong>ไม่สำคัญและไม่เร่งด่วน</strong> - ตัดออก</li>
      </ul>
     </div><!-- กิจกรรมที่ 3: Eisenhower Matrix -->
     <div class="activity-container" id="activity3">
      <div class="activity-title">
       ⏰ กิจกรรม: จัดงานตาม Eisenhower Matrix
      </div>
      <p>ลากงานต่างๆ ไปใส่ในช่องที่เหมาะสม</p>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 1rem 0;">
       <div class="drop-zone" id="urgent-important" style="background: #FFCDD2;">
        <h4>เร่งด่วน + สำคัญ</h4>
        <p>ทำทันที</p>
       </div>
       <div class="drop-zone" id="not-urgent-important" style="background: #C8E6C9;">
        <h4>ไม่เร่งด่วน + สำคัญ</h4>
        <p>วางแผนทำ</p>
       </div>
       <div class="drop-zone" id="urgent-not-important" style="background: #FFF9C4;">
        <h4>เร่งด่วน + ไม่สำคัญ</h4>
        <p>มอบหมาย</p>
       </div>
       <div class="drop-zone" id="not-urgent-not-important" style="background: #F3E5F5;">
        <h4>ไม่เร่งด่วน + ไม่สำคัญ</h4>
        <p>ตัดออก</p>
       </div>
      </div>
      <div class="drag-source" style="margin-top: 1rem;">
       <h4>งานที่ต้องจัดลำดับ</h4>
       <div class="drag-item" draggable="true" data-task="emergency">
        แก้ไขปัญหาเร่งด่วนของลูกค้า
       </div>
       <div class="drag-item" draggable="true" data-task="planning">
        วางแผนโครงการใหม่
       </div>
       <div class="drag-item" draggable="true" data-task="meeting">
        ประชุมประจำสัปดาห์
       </div>
       <div class="drag-item" draggable="true" data-task="social">
        เล่นเกมในมือถือ
       </div>
      </div><button class="btn btn-success" onclick="checkActivity3()" style="margin-top: 1rem;"> ✅ ตรวจคำตอบ </button>
     </div>
    </div>
   </section><!-- Section 4: เครื่องมือจัดการงาน -->
   <section class="lesson-section" id="section4">
    <div class="section-header locked" onclick="toggleSection(4)" role="button" tabindex="0" aria-expanded="false">
     <h2 class="section-title">4. เครื่องมือจัดการงานและโครงการ</h2><span class="section-icon">🔒</span>
    </div>
    <div class="section-content" id="content4">
     <div class="content-text">
      <p>เครื่องมือที่ช่วยในการจัดการงาน เช่น PDCA Cycle และ Kanban Board ช่วยให้ทีมงานสามารถติดตามความคืบหน้าและปรับปรุงการทำงานได้อย่างต่อเนื่อง</p>
     </div>
     <div class="highlight-box">
      <div class="highlight-title">
       PDCA Cycle
      </div>
      <ul>
       <li><strong>Plan</strong> - วางแผน</li>
       <li><strong>Do</strong> - ปฏิบัติ</li>
       <li><strong>Check</strong> - ตรวจสอบ</li>
       <li><strong>Act</strong> - ปรับปรุง</li>
      </ul>
     </div><!-- กิจกรรมที่ 4: Kanban Board -->
     <div class="activity-container" id="activity4">
      <div class="activity-title">
       📋 กิจกรรม: จัดการงานด้วย Kanban Board
      </div>
      <p>ลองเพิ่มงานและย้ายงานระหว่างสถานะต่างๆ</p>
      <div class="kanban-board">
       <div class="kanban-column">
        <div class="kanban-header todo-header">
         📝 To-Do
        </div>
        <div id="todo-cards">
         <div class="kanban-card" draggable="true">
          เตรียมเอกสารประชุม
         </div>
         <div class="kanban-card" draggable="true">
          ติดต่อลูกค้า
         </div>
        </div><button class="add-card-btn" onclick="addKanbanCard('todo')">+ เพิ่มงาน</button>
       </div>
       <div class="kanban-column">
        <div class="kanban-header doing-header">
         ⚡ Doing
        </div>
        <div id="doing-cards">
         <div class="kanban-card" draggable="true">
          ทำรายงานประจำเดือน
         </div>
        </div><button class="add-card-btn" onclick="addKanbanCard('doing')">+ เพิ่มงาน</button>
       </div>
       <div class="kanban-column">
        <div class="kanban-header done-header">
         ✅ Done
        </div>
        <div id="done-cards">
         <div class="kanban-card" draggable="true">
          ส่งอีเมลแจ้งลูกค้า
         </div>
        </div><button class="add-card-btn" onclick="addKanbanCard('done')">+ เพิ่มงาน</button>
       </div>
      </div><button class="btn btn-success" onclick="completeActivity4()" style="margin-top: 1rem;"> ✅ เสร็จสิ้นกิจกรรม </button>
     </div>
    </div>
   </section><!-- Section 5: การแก้ไขข้อขัดแย้ง -->
   <section class="lesson-section" id="section5">
    <div class="section-header locked" onclick="toggleSection(5)" role="button" tabindex="0" aria-expanded="false">
     <h2 class="section-title">5. การแก้ไขข้อขัดแย้งในทีม</h2><span class="section-icon">🔒</span>
    </div>
    <div class="section-content" id="content5">
     <div class="content-text">
      <p>ข้อขัดแย้งเป็นเรื่องปกติในการทำงานร่วมกัน สิ่งสำคัญคือการจัดการข้อขัดแย้งให้เป็นโอกาสในการเรียนรู้และพัฒนาทีม</p>
     </div>
     <div class="highlight-box">
      <div class="highlight-title">
       ขั้นตอนการแก้ไขข้อขัดแย้ง
      </div>
      <ul>
       <li>ระบุปัญหาและสาเหตุ</li>
       <li>ฟังความคิดเห็นทุกฝ่าย</li>
       <li>หาจุดร่วมและความแตกต่าง</li>
       <li>หาทางออกที่ทุกฝ่ายยอมรับได้</li>
       <li>ติดตามผลและปรับปรุง</li>
      </ul>
     </div><!-- กิจกรรมที่ 5: สถานการณ์จำลอง -->
     <div class="activity-container" id="activity5">
      <div class="activity-title">
       🤝 กิจกรรม: แก้ไขข้อขัดแย้ง
      </div>
      <p>เลือกวิธีการที่เหมาะสมในการแก้ไขสถานการณ์ต่อไปนี้:</p>
      <div style="background: var(--white); padding: 1.5rem; border-radius: 8px; margin: 1rem 0;">
       <p><strong>สถานการณ์:</strong> สมาชิกในทีมมีความเห็นไม่ตรงกันเรื่องการกำหนดเวลาส่งงาน คนหนึ่งต้องการเวลามากกว่า แต่อีกคนต้องการส่งให้เร็วที่สุด</p>
      </div>
      <div class="quiz-options">
       <div class="quiz-option" onclick="selectConflictOption(1)" data-option="1">
        ให้คนที่มีอำนาจมากกว่าตัดสินใจ
       </div>
       <div class="quiz-option" onclick="selectConflictOption(2)" data-option="2">
        หาจุดกึ่งกลางโดยการประชุมร่วมกัน
       </div>
       <div class="quiz-option" onclick="selectConflictOption(3)" data-option="3">
        ให้แต่ละคนทำงานแยกกัน
       </div>
       <div class="quiz-option" onclick="selectConflictOption(4)" data-option="4">
        เพิกเฉยต่อปัญหา
       </div>
      </div><button class="btn btn-success" onclick="checkActivity5()" style="margin-top: 1rem;"> ✅ ตรวจคำตอบ </button>
     </div>
    </div>
   </section><!-- Quiz Section -->
   <section class="lesson-section" id="quizSection">
    <div class="section-header locked" onclick="startQuiz()" role="button" tabindex="0" aria-expanded="false">
     <h2 class="section-title">🎯 แบบทดสอบท้ายบทเรียน</h2><span class="section-icon">🔒</span>
    </div>
    <div class="section-content" id="quizContent">
     <div class="quiz-container">
      <div class="quiz-question" id="quizQuestion"></div>
      <div class="quiz-options" id="quizOptions"></div>
      <div class="quiz-feedback" id="quizFeedback"></div>
      <div class="quiz-navigation"><button class="btn btn-secondary" onclick="previousQuestion()" id="prevBtn" disabled> ← ก่อนหน้า </button>
       <div class="quiz-progress" id="quizProgress"></div><button class="btn btn-primary" onclick="nextQuestion()" id="nextBtn"> ถัดไป → </button>
      </div>
     </div>
    </div>
   </section><!-- Results Section -->
   <div class="score-display" id="finalResults" style="display: none;">
    <div class="score-number" id="finalScore">
     0%
    </div>
    <div class="score-text" id="finalMessage">
     ยินดีด้วย! คุณผ่านการทดสอบแล้ว
    </div><button class="btn btn-primary" onclick="restartLesson()" style="margin-top: 1rem;"> 🔄 เรียนใหม่ </button>
   </div>
  </main><!-- Footer -->
  <footer class="footer">
   <div class="footer-content">
    <p>© โรงเรียนสารคามพิทยาคม สพม.มหาสารคาม</p>
    <p>ครูผู้สอน: นางปัญจรัศม์ แซ่ตัง</p>
    <p>เวอร์ชันบทเรียน 1.0 | พัฒนาเพื่อการศึกษา</p>
   </div>
  </footer>
  <script>
        // ตัวแปรสำหรับจัดการสถานะ
        let currentSection = 0;
        let completedActivities = [];
        let currentQuizQuestion = 0;
        let quizAnswers = [];
        let totalScore = 0;
        let selectedConflictOption = null;

        // ข้อมูลแบบทดสอบ
        const quizData = [
            {
                question: "การทำงานร่วมกันที่มีประสิทธิภาพต้องมีองค์ประกอบใดบ้าง?",
                options: [
                    "เป้าหมายที่ชัดเจนและการแบ่งหน้าที่",
                    "การแข่งขันระหว่างสมาชิก",
                    "การทำงานแยกกันโดยไม่ต้องประสานงาน",
                    "การให้คนเก่งทำงานทั้งหมด"
                ],
                correct: 0,
                explanation: "การทำงานร่วมกันที่ดีต้องมีเป้าหมายที่ชัดเจนและการแบ่งหน้าที่ที่เหมาะสม"
            },
            {
                question: "หลัก 5W1H ใช้สำหรับอะไร?",
                options: [
                    "การจัดการเวลา",
                    "การสื่อสารให้ชัดเจน",
                    "การแก้ไขข้อขัดแย้ง",
                    "การประเมินผลงาน"
                ],
                correct: 1,
                explanation: "หลัก 5W1H ช่วยให้การสื่อสารมีความชัดเจนและครบถ้วน"
            },
            {
                question: "ใน Eisenhower Matrix งานที่สำคัญและเร่งด่วนควรทำอย่างไร?",
                options: [
                    "วางแผนทำในอนาคต",
                    "มอบหมายให้ผู้อื่น",
                    "ทำทันที",
                    "ตัดออกจากรายการ"
                ],
                correct: 2,
                explanation: "งานที่สำคัญและเร่งด่วนต้องทำทันทีเพื่อป้องกันปัญหา"
            },
            {
                question: "PDCA Cycle ย่อมาจากอะไร?",
                options: [
                    "Plan-Do-Check-Act",
                    "Prepare-Develop-Control-Analyze",
                    "Process-Design-Create-Apply",
                    "Project-Deliver-Complete-Assess"
                ],
                correct: 0,
                explanation: "PDCA คือ Plan (วางแผน) Do (ปฏิบัติ) Check (ตรวจสอบ) Act (ปรับปรุง)"
            },
            {
                question: "การฟังอย่างตั้งใจ (Active Listening) หมายถึงอะไร?",
                options: [
                    "การฟังโดยไม่แสดงความคิดเห็น",
                    "การฟังและตอบกลับทันที",
                    "การฟังด้วยความตั้งใจและเข้าใจ",
                    "การฟังเฉพาะสิ่งที่ต้องการ"
                ],
                correct: 2,
                explanation: "Active Listening คือการฟังด้วยความตั้งใจเพื่อเข้าใจผู้พูดอย่างแท้จริง"
            },
            {
                question: "บทบาทของ Timekeeper ในทีมคืออะไร?",
                options: [
                    "นำทีมและตัดสินใจ",
                    "บันทึกข้อมูลการประชุม",
                    "ดูแลเวลาและกำหนดการ",
                    "อำนวยความสะดวกในการประชุม"
                ],
                correct: 2,
                explanation: "Timekeeper มีหน้าที่ดูแลเวลาและกำหนดการให้เป็นไปตามแผน"
            },
            {
                question: "Kanban Board ช่วยในการจัดการงานอย่างไร?",
                options: [
                    "แสดงความคืบหน้าของงานแต่ละขั้นตอน",
                    "คำนวณค่าใช้จ่ายของโครงการ",
                    "ประเมินผลการปฏิบัติงาน",
                    "จัดลำดับความสำคัญของงาน"
                ],
                correct: 0,
                explanation: "Kanban Board ช่วยให้เห็นความคืบหน้าของงานในแต่ละขั้นตอนอย่างชัดเจน"
            },
            {
                question: "การแก้ไขข้อขัดแย้งที่ดีควรเริ่มจากอะไร?",
                options: [
                    "หาคนผิดและลงโทษ",
                    "ระบุปัญหาและสาเหตุ",
                    "ให้ผู้บริหารตัดสินใจ",
                    "เพิกเฉยจนกว่าจะหายไป"
                ],
                correct: 1,
                explanation: "การแก้ไขข้อขัดแย้งต้องเริ่มจากการระบุปัญหาและสาเหตุที่แท้จริง"
            },
            {
                question: "ประโยชน์หลักของการทำงานเป็นทีมคืออะไร?",
                options: [
                    "ลดความรับผิดชอบของแต่ละคน",
                    "ได้แนวคิดหลากหลายและแบ่งปันภาระ",
                    "ทำให้งานเสร็จช้าลงแต่มีคุณภาพ",
                    "หลีกเลี่ยงการตัดสินใจที่ยาก"
                ],
                correct: 1,
                explanation: "การทำงานเป็นทีมช่วยให้ได้แนวคิดที่หลากหลายและแบ่งปันภาระงาน"
            },
            {
                question: "เทคนิค Timeboxing คืออะไร?",
                options: [
                    "การจัดเก็บเอกสารตามเวลา",
                    "การกำหนดเวลาจำกัดสำหรับแต่ละงาน",
                    "การทำงานโดยไม่จำกัดเวลา",
                    "การแบ่งเวลาตามความสำคัญ"
                ],
                correct: 1,
                explanation: "Timeboxing คือการกำหนดเวลาจำกัดสำหรับแต่ละงานเพื่อเพิ่มประสิทธิภาพ"
            }
        ];

        // ฟังก์ชันเริ่มบทเรียน
        function startLesson() {
            document.getElementById('section1').scrollIntoView({ behavior: 'smooth' });
            toggleSection(1);
        }

        // ฟังก์ชันเปิด/ปิดส่วนเนื้อหา
        function toggleSection(sectionNum) {
            const section = document.getElementById(`section${sectionNum}`);
            const content = document.getElementById(`content${sectionNum}`);
            const header = section.querySelector('.section-header');
            const icon = header.querySelector('.section-icon');

            // ตรวจสอบว่าส่วนนี้ปลดล็อกแล้วหรือไม่
            if (sectionNum > 1 && !completedActivities.includes(sectionNum - 1)) {
                showToast('กรุณาทำกิจกรรมในส่วนก่อนหน้าให้เสร็จก่อน', 'warning');
                return;
            }

            // เปิด/ปิดเนื้อหา
            if (content.classList.contains('active')) {
                content.classList.remove('active');
                icon.textContent = header.classList.contains('locked') ? '🔒' : '📚';
                header.setAttribute('aria-expanded', 'false');
            } else {
                // ปิดส่วนอื่นๆ
                document.querySelectorAll('.section-content').forEach(c => {
                    c.classList.remove('active');
                });
                document.querySelectorAll('.section-header').forEach(h => {
                    h.setAttribute('aria-expanded', 'false');
                    const i = h.querySelector('.section-icon');
                    if (h.classList.contains('locked')) {
                        i.textContent = '🔒';
                    } else {
                        i.textContent = '📚';
                    }
                });

                content.classList.add('active');
                icon.textContent = '📖';
                header.setAttribute('aria-expanded', 'true');
                currentSection = sectionNum;
            }

            updateProgress();
        }

        // ฟังก์ชันปลดล็อกส่วนถัดไป
        function unlockNextSection(completedSection) {
            completedActivities.push(completedSection);
            
            const nextSectionNum = completedSection + 1;
            const nextSection = document.getElementById(`section${nextSectionNum}`) || document.getElementById('quizSection');
            
            if (nextSection) {
                const header = nextSection.querySelector('.section-header');
                const icon = header.querySelector('.section-icon');
                
                header.classList.remove('locked');
                
                if (nextSectionNum <= 5) {
                    icon.textContent = '📚';
                } else {
                    icon.textContent = '🎯';
                }
                
                showToast(`ปลดล็อกส่วนที่ ${nextSectionNum} แล้ว!`, 'success');
            }

            updateProgress();
            saveProgress();
        }

        // ฟังก์ชันอัพเดทความคืบหน้า
        function updateProgress() {
            const totalSections = 6; // 5 sections + quiz
            const progress = (completedActivities.length / totalSections) * 100;
            
            document.getElementById('progressFill').style.width = `${progress}%`;
            document.getElementById('progressText').textContent = `ความคืบหน้า: ${Math.round(progress)}%`;
        }

        // ฟังก์ชันแสดงข้อความแจ้งเตือน
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background: ${type === 'success' ? 'var(--success)' : type === 'warning' ? 'var(--accent)' : 'var(--primary)'};
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 8px;
                box-shadow: var(--shadow-lg);
                z-index: 10000;
                animation: slideIn 0.3s ease;
            `;
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // กิจกรรมที่ 1: จับคู่บทบาท
        function setupDragAndDrop() {
            const dragItems = document.querySelectorAll('.drag-item');
            const dropZones = document.querySelectorAll('.drop-zone');

            dragItems.forEach(item => {
                item.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('text/plain', e.target.dataset.role || e.target.dataset.step || e.target.dataset.task);
                    e.target.classList.add('dragging');
                });

                item.addEventListener('dragend', (e) => {
                    e.target.classList.remove('dragging');
                });
            });

            dropZones.forEach(zone => {
                zone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    zone.style.background = '#E8F5E8';
                });

                zone.addEventListener('dragleave', (e) => {
                    zone.style.background = '';
                });

                zone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    const data = e.dataTransfer.getData('text/plain');
                    const draggedElement = document.querySelector(`[data-role="${data}"], [data-step="${data}"], [data-task="${data}"]`);
                    
                    if (draggedElement) {
                        zone.appendChild(draggedElement);
                        zone.style.background = '';
                    }
                });
            });
        }

        function checkActivity1() {
            const dropZone = document.getElementById('roleDropZone');
            const droppedItem = dropZone.querySelector('.drag-item');
            
            if (droppedItem && droppedItem.dataset.role === 'leader') {
                showToast('ถูกต้อง! ผู้นำทีมมีหน้าที่วางแผนและประสานงาน', 'success');
                document.getElementById('activity1').classList.add('completed-activity');
                unlockNextSection(1);
            } else {
                showToast('ลองใหม่อีกครั้ง คิดดูว่าใครที่มีหน้าที่วางแผนและประสานงาน', 'warning');
            }
        }

        function checkActivity2() {
            const dropZone = document.getElementById('communicationDropZone');
            const items = dropZone.querySelectorAll('.drag-item');
            const correctOrder = ['1', '2', '3', '4'];
            
            let isCorrect = true;
            if (items.length !== 4) {
                isCorrect = false;
            } else {
                items.forEach((item, index) => {
                    if (item.dataset.step !== correctOrder[index]) {
                        isCorrect = false;
                    }
                });
            }
            
            if (isCorrect) {
                showToast('ยอดเยี่ยม! ลำดับขั้นตอนการสื่อสารถูกต้อง', 'success');
                document.getElementById('activity2').classList.add('completed-activity');
                unlockNextSection(2);
            } else {
                showToast('ลำดับยังไม่ถูกต้อง ลองจัดเรียงใหม่', 'warning');
            }
        }

        function checkActivity3() {
            const zones = {
                'urgent-important': document.getElementById('urgent-important'),
                'not-urgent-important': document.getElementById('not-urgent-important'),
                'urgent-not-important': document.getElementById('urgent-not-important'),
                'not-urgent-not-important': document.getElementById('not-urgent-not-important')
            };

            const correctPlacements = {
                'emergency': 'urgent-important',
                'planning': 'not-urgent-important',
                'meeting': 'urgent-not-important',
                'social': 'not-urgent-not-important'
            };

            let correctCount = 0;
            let totalTasks = Object.keys(correctPlacements).length;

            Object.entries(zones).forEach(([zoneId, zone]) => {
                const tasks = zone.querySelectorAll('.drag-item');
                tasks.forEach(task => {
                    if (correctPlacements[task.dataset.task] === zoneId) {
                        correctCount++;
                    }
                });
            });

            if (correctCount === totalTasks) {
                showToast('เยี่ยมมาก! การจัดลำดับความสำคัญถูกต้องทั้งหมด', 'success');
                document.getElementById('activity3').classList.add('completed-activity');
                unlockNextSection(3);
            } else {
                showToast(`ถูกต้อง ${correctCount}/${totalTasks} ข้อ ลองดูใหม่อีกครั้ง`, 'warning');
            }
        }

        // Kanban Board Functions
        function setupKanbanBoard() {
            const columns = document.querySelectorAll('.kanban-column');
            
            columns.forEach(column => {
                column.addEventListener('dragover', (e) => {
                    e.preventDefault();
                });

                column.addEventListener('drop', (e) => {
                    e.preventDefault();
                    const cardData = e.dataTransfer.getData('text/plain');
                    const draggedCard = document.querySelector(`[data-card-id="${cardData}"]`);
                    
                    if (draggedCard) {
                        const cardsContainer = column.querySelector('[id$="-cards"]');
                        cardsContainer.appendChild(draggedCard);
                    }
                });
            });

            // Setup existing cards
            document.querySelectorAll('.kanban-card').forEach((card, index) => {
                card.dataset.cardId = `card-${index}`;
                card.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('text/plain', e.target.dataset.cardId);
                });
            });
        }

        function addKanbanCard(columnType) {
            const taskName = prompt('ใส่ชื่องานใหม่:');
            if (taskName && taskName.trim()) {
                const card = document.createElement('div');
                card.className = 'kanban-card';
                card.draggable = true;
                card.textContent = taskName.trim();
                card.dataset.cardId = `card-${Date.now()}`;
                
                card.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('text/plain', e.target.dataset.cardId);
                });

                const container = document.getElementById(`${columnType}-cards`);
                container.appendChild(card);
            }
        }

        function completeActivity4() {
            showToast('เรียนรู้การใช้ Kanban Board เสร็จสิ้น!', 'success');
            document.getElementById('activity4').classList.add('completed-activity');
            unlockNextSection(4);
        }

        // Activity 5: Conflict Resolution
        function selectConflictOption(optionNum) {
            document.querySelectorAll('#activity5 .quiz-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            document.querySelector(`#activity5 .quiz-option[data-option="${optionNum}"]`).classList.add('selected');
            selectedConflictOption = optionNum;
        }

        function checkActivity5() {
            if (selectedConflictOption === 2) {
                showToast('ถูกต้อง! การหาจุดกึ่งกลางโดยการประชุมร่วมกันเป็นวิธีที่ดีที่สุด', 'success');
                document.getElementById('activity5').classList.add('completed-activity');
                unlockNextSection(5);
            } else {
                showToast('ลองคิดดูใหม่ วิธีไหนที่จะทำให้ทุกฝ่ายพอใจ', 'warning');
            }
        }

        // Quiz Functions
        function startQuiz() {
            if (!completedActivities.includes(5)) {
                showToast('กรุณาทำกิจกรรมทั้งหมดให้เสร็จก่อน', 'warning');
                return;
            }

            document.getElementById('quizContent').style.display = 'block';
            currentQuizQuestion = 0;
            quizAnswers = [];
            
            // สุ่มคำถาม
            quizData.sort(() => Math.random() - 0.5);
            
            showQuizQuestion();
        }

        function showQuizQuestion() {
            const question = quizData[currentQuizQuestion];
            document.getElementById('quizQuestion').textContent = `${currentQuizQuestion + 1}. ${question.question}`;
            
            const optionsContainer = document.getElementById('quizOptions');
            optionsContainer.innerHTML = '';
            
            // สุ่มตัวเลือก
            const shuffledOptions = question.options.map((option, index) => ({ option, index }));
            shuffledOptions.sort(() => Math.random() - 0.5);
            
            shuffledOptions.forEach(({ option, index }) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'quiz-option';
                optionDiv.textContent = option;
                optionDiv.onclick = () => selectQuizOption(index, optionDiv);
                optionsContainer.appendChild(optionDiv);
            });

            document.getElementById('quizProgress').textContent = `คำถามที่ ${currentQuizQuestion + 1} จาก ${quizData.length}`;
            document.getElementById('prevBtn').disabled = currentQuizQuestion === 0;
            document.getElementById('nextBtn').textContent = currentQuizQuestion === quizData.length - 1 ? 'ดูผล' : 'ถัดไป →';
            
            // ซ่อน feedback
            document.getElementById('quizFeedback').classList.remove('show');
        }

        function selectQuizOption(answerIndex, optionElement) {
            document.querySelectorAll('#quizOptions .quiz-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            optionElement.classList.add('selected');
            quizAnswers[currentQuizQuestion] = answerIndex;
        }

        function nextQuestion() {
            if (quizAnswers[currentQuizQuestion] === undefined) {
                showToast('กรุณาเลือกคำตอบก่อน', 'warning');
                return;
            }

            if (currentQuizQuestion === quizData.length - 1) {
                showQuizResults();
            } else {
                currentQuizQuestion++;
                showQuizQuestion();
            }
        }

        function previousQuestion() {
            if (currentQuizQuestion > 0) {
                currentQuizQuestion--;
                showQuizQuestion();
            }
        }

        function showQuizResults() {
            let correctAnswers = 0;
            
            quizAnswers.forEach((answer, index) => {
                if (answer === quizData[index].correct) {
                    correctAnswers++;
                }
            });

            const percentage = Math.round((correctAnswers / quizData.length) * 100);
            totalScore = percentage;

            document.getElementById('quizContent').style.display = 'none';
            document.getElementById('finalResults').style.display = 'block';
            document.getElementById('finalScore').textContent = `${percentage}%`;
            
            let message = '';
            if (percentage >= 80) {
                message = 'ยอดเยี่ยม! คุณเข้าใจบทเรียนเป็นอย่างดี';
            } else if (percentage >= 60) {
                message = 'ดีมาก! คุณผ่านการทดสอบแล้ว';
            } else {
                message = 'ควรทบทวนบทเรียนอีกครั้ง';
            }
            
            document.getElementById('finalMessage').textContent = message;
            document.getElementById('scoreValue').textContent = percentage;

            // บันทึกคะแนน
            saveProgress();
            
            if (percentage >= 60) {
                completedActivities.push(6); // Quiz completed
                updateProgress();
            }
        }

        // Storage Functions
        function saveProgress() {
            const progressData = {
                completedActivities: completedActivities,
                totalScore: totalScore,
                timestamp: new Date().toISOString()
            };
            localStorage.setItem('teamworkLessonProgress', JSON.stringify(progressData));
        }

        function loadProgress() {
            const saved = localStorage.getItem('teamworkLessonProgress');
            if (saved) {
                const data = JSON.parse(saved);
                completedActivities = data.completedActivities || [];
                totalScore = data.totalScore || 0;
                
                // ปลดล็อกส่วนที่เสร็จแล้ว
                completedActivities.forEach(sectionNum => {
                    if (sectionNum <= 5) {
                        const nextSection = document.getElementById(`section${sectionNum + 1}`) || document.getElementById('quizSection');
                        if (nextSection) {
                            const header = nextSection.querySelector('.section-header');
                            header.classList.remove('locked');
                            const icon = header.querySelector('.section-icon');
                            icon.textContent = sectionNum + 1 <= 5 ? '📚' : '🎯';
                        }
                    }
                });

                document.getElementById('scoreValue').textContent = totalScore;
                updateProgress();
            }
        }

        function resetProgress() {
            if (confirm('คุณต้องการรีเซ็ตความคืบหน้าทั้งหมดหรือไม่?')) {
                localStorage.removeItem('teamworkLessonProgress');
                location.reload();
            }
        }

        function restartLesson() {
            document.getElementById('finalResults').style.display = 'none';
            document.getElementById('quizContent').style.display = 'none';
            document.querySelector('.hero').scrollIntoView({ behavior: 'smooth' });
        }

        function printResults() {
            const printContent = `
                <h1>ผลการเรียน: ทักษะการทำงานร่วมกันและการจัดการ</h1>
                <p><strong>โรงเรียน:</strong> โรงเรียนสารคามพิทยาคม สพม.มหาสารคาม</p>
                <p><strong>ครูผู้สอน:</strong> นางปัญจรัศม์ แซ่ตัง</p>
                <p><strong>คะแนนรวม:</strong> ${totalScore}%</p>
                <p><strong>กิจกรรมที่เสร็จสิ้น:</strong> ${completedActivities.length}/6</p>
                <p><strong>วันที่:</strong> ${new Date().toLocaleDateString('th-TH')}</p>
                <hr>
                <h2>สรุปการเรียนรู้</h2>
                <ul>
                    <li>ความหมายและความสำคัญของการทำงานร่วมกัน</li>
                    <li>การสื่อสารอย่างมีประสิทธิภาพ</li>
                    <li>การจัดการเวลาและการวางแผน</li>
                    <li>เครื่องมือจัดการงานและโครงการ</li>
                    <li>การแก้ไขข้อขัดแย้งในทีม</li>
                </ul>
            `;
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                    <head>
                        <title>ผลการเรียน</title>
                        <style>
                            body { font-family: 'Prompt', sans-serif; padding: 20px; }
                            h1 { color: #1565C0; }
                            h2 { color: #333; }
                        </style>
                    </head>
                    <body>${printContent}</body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadProgress();
            setupDragAndDrop();
            setupKanbanBoard();
            
            // เพิ่ม CSS animations
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                @keyframes slideOut {
                    from { transform: translateX(0); opacity: 1; }
                    to { transform: translateX(100%); opacity: 0; }
                }
            `;
            document.head.appendChild(style);
        });

        // Accessibility: Keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' || e.key === ' ') {
                if (e.target.classList.contains('section-header')) {
                    e.preventDefault();
                    e.target.click();
                }
            }
        });
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'991eaf4fb76e5f3f',t:'MTc2MTAyODAwMS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>